---
title: "POST /auth/privy/verify"
api: "POST https://api.onekey.so/api/v1/auth/privy/verify"
description: "Verify a Privy Web3 wallet signature and generate an authenticated session"
---

## Overview

Verify a Privy-generated signature from a Web3 wallet and create an authenticated session. This endpoint integrates with Privy's authentication infrastructure to enable seamless Web3 user onboarding.

<Note>
This endpoint requires Privy to be configured in your OneKey dashboard. Users must first authenticate with Privy on the client side.
</Note>

## Request

### Headers

```http
Content-Type: application/json
Accept: application/json
```

### Body Parameters

<ParamField body="privyToken" type="string" required>
  The Privy authentication token from the client
</ParamField>

<ParamField body="walletAddress" type="string" required>
  The connected wallet address
</ParamField>

<ParamField body="signature" type="string" required>
  The signature generated by the wallet
</ParamField>

<ParamField body="message" type="string" required>
  The original message that was signed
</ParamField>

<ParamField body="chainId" type="number" required>
  The blockchain network ID (1 for Ethereum mainnet, 137 for Polygon, etc.)
</ParamField>

<ParamField body="nonce" type="string">
  Optional nonce for replay protection
</ParamField>

<ParamField body="expiresIn" type="string" default="24h">
  Token expiration time for the generated session
</ParamField>

### Example Request

<CodeGroup>

```bash cURL
curl -X POST https://api.onekey.so/api/v1/auth/privy/verify \
  -H "Content-Type: application/json" \
  -d '{
    "privyToken": "privy_token_...",
    "walletAddress": "0x742d35Cc6C88BfD5b3DC4B8A76C04E2dCB3cCF6D",
    "signature": "0x1b2c3d4e5f...",
    "message": "Sign in to OneKey with your wallet. Timestamp: 1640995200",
    "chainId": 1,
    "nonce": "abc123def456"
  }'
```

```javascript JavaScript
import { usePrivy } from '@privy-io/react-auth';

const PrivyAuth = () => {
  const { login, authenticated, user } = usePrivy();
  
  const authenticateWithOneKey = async () => {
    if (!authenticated) {
      await login();
    }
    
    // Get Privy token
    const privyToken = await user.getAccessToken();
    
    // Create signature message
    const message = `Sign in to OneKey with your wallet. Timestamp: ${Date.now()}`;
    
    // Request signature from user's wallet
    const signature = await window.ethereum.request({
      method: 'personal_sign',
      params: [message, user.wallet.address],
    });
    
    // Verify with OneKey
    const response = await fetch('/api/v1/auth/privy/verify', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        privyToken,
        walletAddress: user.wallet.address,
        signature,
        message,
        chainId: user.wallet.chainId,
        nonce: crypto.randomUUID()
      })
    });
    
    const data = await response.json();
    return data.data.accessToken;
  };
  
  return (
    <button onClick={authenticateWithOneKey}>
      Connect Wallet & Authenticate
    </button>
  );
};
```

```python Python
import requests
from eth_account.messages import encode_defunct
from eth_account import Account

def verify_privy_signature(privy_token, wallet_address, private_key, message):
    # Sign the message (this would typically be done client-side)
    message_hash = encode_defunct(text=message)
    signature = Account.sign_message(message_hash, private_key).signature.hex()
    
    response = requests.post(
        'https://api.onekey.so/api/v1/auth/privy/verify',
        headers={'Content-Type': 'application/json'},
        json={
            'privyToken': privy_token,
            'walletAddress': wallet_address,
            'signature': signature,
            'message': message,
            'chainId': 1,
            'nonce': 'unique_nonce_123'
        }
    )
    
    data = response.json()
    return data['data']['accessToken']
```

</CodeGroup>

## Response

<ResponseField name="success" type="boolean">
  Whether the verification was successful
</ResponseField>

<ResponseField name="data" type="object">
  <Expandable title="properties">
    <ResponseField name="accessToken" type="string">
      JWT access token for API authentication
    </ResponseField>
    
    <ResponseField name="tokenType" type="string">
      Token type (always "Bearer")
    </ResponseField>
    
    <ResponseField name="expiresIn" type="number">
      Token expiration time in seconds
    </ResponseField>
    
    <ResponseField name="expiresAt" type="string">
      Token expiration timestamp (ISO 8601)
    </ResponseField>
    
    <ResponseField name="user" type="object">
      <Expandable title="User information">
        <ResponseField name="id" type="string">
          OneKey user identifier
        </ResponseField>
        
        <ResponseField name="walletAddress" type="string">
          Verified wallet address
        </ResponseField>
        
        <ResponseField name="privyId" type="string">
          Privy user identifier
        </ResponseField>
        
        <ResponseField name="chainId" type="number">
          Connected blockchain network
        </ResponseField>
        
        <ResponseField name="walletType" type="string">
          Wallet provider (MetaMask, WalletConnect, etc.)
        </ResponseField>
        
        <ResponseField name="isNewUser" type="boolean">
          Whether this is the user's first authentication
        </ResponseField>
      </Expandable>
    </ResponseField>
    
    <ResponseField name="permissions" type="array">
      Granted permissions for Web3 users
    </ResponseField>
    
    <ResponseField name="session" type="object">
      <Expandable title="Session details">
        <ResponseField name="id" type="string">
          Session identifier
        </ResponseField>
        
        <ResponseField name="createdAt" type="string">
          Session creation timestamp
        </ResponseField>
        
        <ResponseField name="lastActivity" type="string">
          Last activity timestamp
        </ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
</ResponseField>

### Example Response

```json
{
  "success": true,
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "tokenType": "Bearer",
    "expiresIn": 86400,
    "expiresAt": "2024-01-16T10:30:45.123Z",
    "user": {
      "id": "user_1a2b3c4d5e",
      "walletAddress": "0x742d35Cc6C88BfD5b3DC4B8A76C04E2dCB3cCF6D",
      "privyId": "did:privy:clzmk8ej70...",
      "chainId": 1,
      "walletType": "metamask",
      "isNewUser": false
    },
    "permissions": [
      "kyc:read",
      "kyc:write",
      "attestations:read",
      "encryption:use"
    ],
    "session": {
      "id": "session_9f8e7d6c5b",
      "createdAt": "2024-01-15T10:30:45.123Z",
      "lastActivity": "2024-01-15T10:30:45.123Z"
    }
  },
  "requestId": "req_123456789",
  "timestamp": "2024-01-15T10:30:45.123Z"
}
```

## Next Steps

<CardGroup cols={2}>
  <Card title="KYC Sessions" icon="id-card" href="/api-reference/kyc/create-session">
    Start identity verification for authenticated users
  </Card>
  <Card title="Encryption" icon="lock" href="/api-reference/encryption/encrypt">
    Encrypt sensitive data before storage
  </Card>
  <Card title="Attestations" icon="shield" href="/api-reference/attestations/create">
    Create blockchain proofs for verified identities
  </Card>
  <Card title="Web3 Guide" icon="wallet" href="/guides/web3-auth">
    Complete Web3 authentication integration guide
  </Card>
</CardGroup> 